# -*- coding: utf-8 -*-
"""titanic_exploratory_analysis.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1IXLovhyr8zaoAbMnjbeo9jtyA3aGybyx
"""

import pandas as pd
import matplotlib.pyplot as plt
df = pd.read_csv('train.csv')
pd.set_option('display.max_rows', None)
pd.set_option('display.max_columns', None)
df

num_males = (df['Sex'] == 'male').sum()
print(num_males)

num_females = (df['Sex'] == 'female').sum()
print(num_females)

gender_count = df['Sex'].value_counts()
print(gender_count)

total_nan_values = df.isna().sum().sum()
print(total_nan_values)

nan_counts = df.isna().sum()
print(nan_counts)

gender_counts = {'Male': num_males, 'Female': num_females}

plt.figure(figsize=(5, 5))
plt.pie(gender_counts.values(), labels=gender_counts.keys(), autopct='%1.1f%%')
plt.title('Gender Distribution on the Ship')

plt.show()

columns_with_nan = df.columns[df.isna().any()].tolist()
print(columns_with_nan)

rows,columns = df.shape

total_passengers = rows
total_survived = df['Survived'].sum()

total_not_survived = total_passengers - total_survived

labels = ['Passengers Dead', 'Passengers Survived']
sizes = [total_passengers, total_survived]

plt.figure(figsize=(8, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=140)
plt.title('Passengers Dead vs. Passengers Who Survived')
plt.axis('equal')
plt.show()

total_passengers =  rows
total_alive_passengers = df['Survived'].sum()
total_dead_passengers = total_passengers - total_alive_passengers

passengers_data = pd.DataFrame({'Alive Passengers': [total_alive_passengers],
                                'Dead Passengers': [total_dead_passengers]},
                                index=['Total Passengers'])

passengers_data.plot(kind='bar', stacked=True, figsize=(6, 6))
plt.title('Alive vs. Dead Passengers on Titanic')
plt.xlabel('Category')
plt.ylabel('Count')
plt.legend(title='Passenger Status')
plt.show()

total_passengers = rows
total_alive_passengers = df['Survived'].sum()
total_dead_passengers = total_passengers - total_alive_passengers
print("Total Passengers: ",total_passengers)
print("Total dead people:",total_dead_passengers)
print("Total alive people:",total_alive_passengers)

total_survived = df['Survived'].sum()
total_not_survived = rows - total_survived

labels = ['Passengers Survived', 'Passengers Dead']
sizes = [total_survived, total_not_survived]

plt.figure(figsize=(8, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Passengers Who Survived vs. Passengers Who Died on Titanic')
plt.show()

total_females = (df['Sex'] == 'female').sum()
total_females_died = ((df['Sex'] == 'female') & (df['Survived'] == 0)).sum()
labels = ['Total Females', 'Females Who Died']
sizes = [total_females, total_females_died]

plt.figure(figsize=(8, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Total Females vs. Females Who Died on Titanic')

plt.show()

females_survived = df[(df['Sex'] == 'female') & (df['Survived'] == 1)].shape[0]

labels = ['Survived Females', 'Dead Females']
sizes = [females_survived,314-233]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Survived Females vs Dead Females')
plt.show()

total_males = (df['Sex'] == 'male').sum()
total_males_died = ((df['Sex'] == 'male') & (df['Survived'] == 0)).sum()


labels = ['Total Males', 'Males Who Died']
sizes = [total_males, total_males_died]

plt.figure(figsize=(8, 6))
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=140)
plt.title('Total Males vs. Males Who Died on Titanic')
plt.show()

males_survived = df[(df['Sex'] == 'male') & (df['Survived'] == 1)].shape[0]

labels = ['Survived Males', 'Dead Males']
sizes = [males_survived,577-109]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Males survived vs Males Died')
plt.show()

embarked_counts = df['Embarked'].value_counts()

majority_embarked = embarked_counts.idxmax()

df['Embarked'].fillna(majority_embarked, inplace=True)

df.to_csv("train.csv", index=False)

print('Oldest Passenger was of:',df['Age'].max(),'Years')
print('Youngest Passenger was of:',df['Age'].min(),'Years')
print('Average Age on the ship:',df['Age'].mean(),'Years')

nan_counts = df.isna().sum()
print(nan_counts)

df['Cabin'].fillna('Unknown', inplace=True)
df['Cabin_Available'] = df['Cabin'].apply(lambda x: 0 if x == 'Unknown' else 1)

df['Deck'] = df['Cabin'].str.slice(0, 1)

nan_counts = df.isna().sum()
print(nan_counts)

mean_age = df['Age'].mean()

df['Age'].fillna(mean_age, inplace=True)

nan_counts = df.isna().sum()
print(nan_counts)

passengers_per_class = df.groupby('Pclass').size()


print("Total number of passengers in each class:")
print(passengers_per_class)

passengers_per_class_sex = df.groupby(['Pclass', 'Sex']).size()
print(passengers_per_class_sex)

passengers_per_class_sex = df.groupby(['Pclass', 'Sex']).size().unstack()
passengers_per_class_sex.plot(kind='bar', stacked=True, figsize=(10, 6))


plt.title('Number of Males and Females in Each Passenger Class')
plt.xlabel('Passenger Class')
plt.ylabel('Number of Passengers')

plt.legend(title='Sex')
plt.show()

survived_males = df[(df['Sex'] == 'male') & (df['Survived'] == 1) & (df['Pclass'].isin([1, 2, 3]))]

total_survived_males_per_class = survived_males.groupby('Pclass').size()

print("Total males survived from each class:")
print(total_survived_males_per_class)

total_survived_males_per_class.plot(kind='pie', colors=['skyblue', 'orange', 'green'], autopct='%1.1f%%', figsize=(8, 6))

plt.title('Distribution of Males Survived Across Passenger Classes')
plt.ylabel('')
plt.legend(title='Passenger Class', loc='upper right')
plt.show()

survived_females = df[(df['Sex'] == 'female') & (df['Survived'] == 1) & (df['Pclass'].isin([1, 2, 3]))]

total_survived_females_per_class = survived_females.groupby('Pclass').size()

total_survived_females_per_class.plot(kind='pie', colors=['lightgreen', 'lightblue', 'lightcoral'], autopct='%1.1f%%', figsize=(8, 6))

plt.title('Distribution of Females Survived Across Passenger Classes')
plt.ylabel('')
plt.legend(title='Passenger Class', loc='upper right')
plt.show()

survived_males = df[(df['Sex'] == 'male') & (df['Survived'] == 1) & (df['Pclass'].isin([1, 2, 3]))]
survived_females = df[(df['Sex'] == 'female') & (df['Survived'] == 1) & (df['Pclass'].isin([1, 2, 3]))]

total_survived_males_per_class = survived_males.groupby('Pclass').size()
total_survived_females_per_class = survived_females.groupby('Pclass').size()

fig, ax = plt.subplots(figsize=(10, 6))
ax.bar(total_survived_males_per_class.index, total_survived_males_per_class, color='skyblue', label='Males')


ax.bar(total_survived_females_per_class.index, total_survived_females_per_class, bottom=total_survived_males_per_class, color='lightgreen', label='Females')

ax.set_title('Total Males and Females Survived in Each Passenger Class')
ax.set_xlabel('Passenger Class')
ax.set_ylabel('Total Number of Survivors')
ax.set_xticks(total_survived_males_per_class.index)
ax.set_xticklabels(['1st', '2nd', '3rd'])
ax.legend()
plt.show()

embarked_counts = df['Embarked'].value_counts()
print("Total passengers embarked:")
print(embarked_counts)

plt.figure(figsize=(8, 6))
plt.pie(embarked_counts, labels=embarked_counts.index, autopct='%1.1f%%')
plt.title('Passengers Embarked by Port')
plt.show()

S_survived = df[(df['Embarked'] == 'S') & (df['Survived'] == 1)].shape[0]
C_survived = df[(df['Embarked'] == 'C') & (df['Survived'] == 1)].shape[0]
Q_survived = df[(df['Embarked'] == 'Q') & (df['Survived'] == 1)].shape[0]
print('Total passengers that survived from S Port' ,S_survived)
print('Total passengers that survived from C Port' ,C_survived)
print('Total passengers that survived from Q Port' ,Q_survived)

plt.figure(figsize=(8, 6))
labels = ['Southampton', 'Cherbourg', 'Queenstown']
sizes = [S_survived, C_survived, Q_survived]
plt.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=90)
plt.title('Survival Distribution by Port of Embarkation')

Fare = df.groupby('Pclass')['Fare'].mean()
print(Fare)

categories = ['Class 1', 'Class 2', 'Class 3']
plt.pie(Fare, labels=categories, autopct='%1.1f%%', colors=['lightblue', 'lightcoral', 'lightgreen'], startangle=140)
plt.title('Distribution of Average Fare Across Passenger Classes')
plt.axis('equal')
plt.show()

Total_Minors = df[df['Age'] < 15].shape[0]
Total_Minors

Minors_survived = df[(df['Age'] <15) & (df['Survived'] == 1)].shape[0]
Minors_survived

labels = ['Total Minors', 'Minors survived']
sizes = [78,45]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Minor Survival Rate')
plt.show()

Total_Adults = df[df['Age'] >= 15].shape[0]
Total_Adults

Adults_survived = df[(df['Age'] >=15) & (df['Survived'] == 1)].shape[0]
Adults_survived

labels = ['Total Adults', 'Adults survived']
sizes = [813,297]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Adult Survival Rate')
plt.show()

Total_old_people = df[(df['Age'] > 60 )].shape[0]
Total_old_people

total_old_people_survived = df[(df['Age'] > 60) & (df['Survived'] == 1)].shape[0]
total_old_people_survived

labels = ['Old People Dead', 'Old People Survived']
sizes = [Total_old_people,total_old_people_survived]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('Survival distribution for Old people')

numeric_df = df.select_dtypes(include=['float64', 'int64'])
correlation_matrix = numeric_df.corr()
print(correlation_matrix)

df['Sex'] = df['Sex'].map({'male': 0, 'female': 1})
correlation_matrix = df['Sex'].corr(df['Survived'])
correlation_matrix

import seaborn as sns
sns.heatmap(correlation_matrix, annot=True)
plt.title('Correlation Matrix')
plt.show()

passengers_with_family = df[(df['SibSp'] > 0) | (df['Parch'] > 0)].shape[0]
passengers_with_family

passengers_with_family = df[(df['SibSp'] > 0) | (df['Parch'] > 0)]

num_passengers_died_with_family = passengers_with_family[passengers_with_family['Survived'] == 0].shape[0]

num_passengers_died_with_family

num_passengers_died_with_family = passengers_with_family[passengers_with_family['Survived'] == 0].shape[0]
num_passengers_survived_with_family = passengers_with_family[passengers_with_family['Survived'] == 1].shape[0]

labels = ['Survived', 'Died']
sizes = [num_passengers_survived_with_family, num_passengers_died_with_family]
plt.pie(sizes, labels=labels, autopct='%1.1f%%')
plt.title('People With Atleast One Family Member')
plt.show()

! pip install ydata_profiling
import matplotlib.pyplot as plt
import pandas as pd
from ydata_profiling import ProfileReport
df = pd.read_csv('train.csv')
profile = ProfileReport(df)
profile.to_file('EDA_1.html')

